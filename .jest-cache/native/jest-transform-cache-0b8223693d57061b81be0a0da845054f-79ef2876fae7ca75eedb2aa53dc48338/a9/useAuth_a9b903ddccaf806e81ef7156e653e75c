792f8a65773e39f773001ccc4e8e13a3
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _react = require("react");
var _reactRedux = require("react-redux");
var _selectors = require("../store/selectors");
var _auth = require("../store/slices/auth.slice");
var normalizeRole = function normalizeRole(role) {
  if (!role) return null;
  return String(role).trim().toLowerCase();
};
var normalizeRoles = function normalizeRoles(roles) {
  if (!roles) return [];
  var list = Array.isArray(roles) ? roles : [roles];
  return list.map(normalizeRole).filter(Boolean);
};
var useAuth = function useAuth() {
  var dispatch = (0, _reactRedux.useDispatch)();
  var isAuthenticated = (0, _reactRedux.useSelector)(_selectors.selectIsAuthenticated);
  var user = (0, _reactRedux.useSelector)(_selectors.selectUser);
  var isLoading = (0, _reactRedux.useSelector)(_selectors.selectAuthLoading);
  var errorCode = (0, _reactRedux.useSelector)(_selectors.selectAuthErrorCode);
  var roles = (0, _react.useMemo)(function () {
    var userRoles = (user == null ? void 0 : user.roles) || (user == null ? void 0 : user.role) || [];
    return normalizeRoles(userRoles);
  }, [user]);
  return {
    isAuthenticated: Boolean(isAuthenticated),
    user: user || null,
    roles: roles,
    role: roles[0] || null,
    isLoading: Boolean(isLoading),
    errorCode: errorCode || null,
    login: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.login(payload));
    }, [dispatch]),
    register: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.register(payload));
    }, [dispatch]),
    logout: (0, _react.useCallback)(function () {
      return dispatch(_auth.actions.logout());
    }, [dispatch]),
    refreshSession: (0, _react.useCallback)(function () {
      return dispatch(_auth.actions.refreshSession());
    }, [dispatch]),
    loadCurrentUser: (0, _react.useCallback)(function () {
      return dispatch(_auth.actions.loadCurrentUser());
    }, [dispatch]),
    verifyEmail: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.verifyEmail(payload));
    }, [dispatch]),
    verifyPhone: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.verifyPhone(payload));
    }, [dispatch]),
    resendVerification: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.resendVerification(payload));
    }, [dispatch]),
    forgotPassword: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.forgotPassword(payload));
    }, [dispatch]),
    resetPassword: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.resetPassword(payload));
    }, [dispatch]),
    changePassword: (0, _react.useCallback)(function (payload) {
      return dispatch(_auth.actions.changePassword(payload));
    }, [dispatch]),
    clearError: (0, _react.useCallback)(function () {
      return dispatch(_auth.actions.clearAuthError());
    }, [dispatch])
  };
};
var _default = exports.default = useAuth;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3JlYWN0UmVkdXgiLCJfc2VsZWN0b3JzIiwiX2F1dGgiLCJub3JtYWxpemVSb2xlIiwicm9sZSIsIlN0cmluZyIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsIm5vcm1hbGl6ZVJvbGVzIiwicm9sZXMiLCJsaXN0IiwiQXJyYXkiLCJpc0FycmF5IiwibWFwIiwiZmlsdGVyIiwiQm9vbGVhbiIsInVzZUF1dGgiLCJkaXNwYXRjaCIsInVzZURpc3BhdGNoIiwiaXNBdXRoZW50aWNhdGVkIiwidXNlU2VsZWN0b3IiLCJzZWxlY3RJc0F1dGhlbnRpY2F0ZWQiLCJ1c2VyIiwic2VsZWN0VXNlciIsImlzTG9hZGluZyIsInNlbGVjdEF1dGhMb2FkaW5nIiwiZXJyb3JDb2RlIiwic2VsZWN0QXV0aEVycm9yQ29kZSIsInVzZU1lbW8iLCJ1c2VyUm9sZXMiLCJsb2dpbiIsInVzZUNhbGxiYWNrIiwicGF5bG9hZCIsImF1dGhBY3Rpb25zIiwicmVnaXN0ZXIiLCJsb2dvdXQiLCJyZWZyZXNoU2Vzc2lvbiIsImxvYWRDdXJyZW50VXNlciIsInZlcmlmeUVtYWlsIiwidmVyaWZ5UGhvbmUiLCJyZXNlbmRWZXJpZmljYXRpb24iLCJmb3Jnb3RQYXNzd29yZCIsInJlc2V0UGFzc3dvcmQiLCJjaGFuZ2VQYXNzd29yZCIsImNsZWFyRXJyb3IiLCJjbGVhckF1dGhFcnJvciIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlcyI6WyJ1c2VBdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiB1c2VBdXRoIEhvb2tcclxuICogUHJvdmlkZXMgbWluaW1hbCBhdXRoIHN0YXRlIGZyb20gUmVkdXggZm9yIFVJIGd1YXJkcy9uYXZpZ2F0aW9uLlxyXG4gKiBGaWxlOiB1c2VBdXRoLmpzXHJcbiAqL1xyXG5pbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlTWVtbyB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgdXNlRGlzcGF0Y2gsIHVzZVNlbGVjdG9yIH0gZnJvbSAncmVhY3QtcmVkdXgnO1xyXG5pbXBvcnQge1xyXG4gIHNlbGVjdEF1dGhFcnJvckNvZGUsXHJcbiAgc2VsZWN0QXV0aExvYWRpbmcsXHJcbiAgc2VsZWN0SXNBdXRoZW50aWNhdGVkLFxyXG4gIHNlbGVjdFVzZXIsXHJcbn0gZnJvbSAnQHN0b3JlL3NlbGVjdG9ycyc7XHJcbmltcG9ydCB7IGFjdGlvbnMgYXMgYXV0aEFjdGlvbnMgfSBmcm9tICdAc3RvcmUvc2xpY2VzL2F1dGguc2xpY2UnO1xyXG5cclxuY29uc3Qgbm9ybWFsaXplUm9sZSA9IChyb2xlKSA9PiB7XHJcbiAgaWYgKCFyb2xlKSByZXR1cm4gbnVsbDtcclxuICByZXR1cm4gU3RyaW5nKHJvbGUpLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xyXG59O1xyXG5cclxuY29uc3Qgbm9ybWFsaXplUm9sZXMgPSAocm9sZXMpID0+IHtcclxuICBpZiAoIXJvbGVzKSByZXR1cm4gW107XHJcbiAgY29uc3QgbGlzdCA9IEFycmF5LmlzQXJyYXkocm9sZXMpID8gcm9sZXMgOiBbcm9sZXNdO1xyXG4gIHJldHVybiBsaXN0Lm1hcChub3JtYWxpemVSb2xlKS5maWx0ZXIoQm9vbGVhbik7XHJcbn07XHJcblxyXG4vKipcclxuICogdXNlQXV0aCBob29rXHJcbiAqIEByZXR1cm5zIHtPYmplY3R9IGF1dGggc3RhdGUgYW5kIG5vcm1hbGl6ZWQgcm9sZXNcclxuICovXHJcbmNvbnN0IHVzZUF1dGggPSAoKSA9PiB7XHJcbiAgY29uc3QgZGlzcGF0Y2ggPSB1c2VEaXNwYXRjaCgpO1xyXG4gIGNvbnN0IGlzQXV0aGVudGljYXRlZCA9IHVzZVNlbGVjdG9yKHNlbGVjdElzQXV0aGVudGljYXRlZCk7XHJcbiAgY29uc3QgdXNlciA9IHVzZVNlbGVjdG9yKHNlbGVjdFVzZXIpO1xyXG4gIGNvbnN0IGlzTG9hZGluZyA9IHVzZVNlbGVjdG9yKHNlbGVjdEF1dGhMb2FkaW5nKTtcclxuICBjb25zdCBlcnJvckNvZGUgPSB1c2VTZWxlY3RvcihzZWxlY3RBdXRoRXJyb3JDb2RlKTtcclxuXHJcbiAgY29uc3Qgcm9sZXMgPSB1c2VNZW1vKCgpID0+IHtcclxuICAgIGNvbnN0IHVzZXJSb2xlcyA9IHVzZXI/LnJvbGVzIHx8IHVzZXI/LnJvbGUgfHwgW107XHJcbiAgICByZXR1cm4gbm9ybWFsaXplUm9sZXModXNlclJvbGVzKTtcclxuICB9LCBbdXNlcl0pO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgaXNBdXRoZW50aWNhdGVkOiBCb29sZWFuKGlzQXV0aGVudGljYXRlZCksXHJcbiAgICB1c2VyOiB1c2VyIHx8IG51bGwsXHJcbiAgICByb2xlcyxcclxuICAgIHJvbGU6IHJvbGVzWzBdIHx8IG51bGwsXHJcbiAgICBpc0xvYWRpbmc6IEJvb2xlYW4oaXNMb2FkaW5nKSxcclxuICAgIGVycm9yQ29kZTogZXJyb3JDb2RlIHx8IG51bGwsXHJcbiAgICBsb2dpbjogdXNlQ2FsbGJhY2soKHBheWxvYWQpID0+IGRpc3BhdGNoKGF1dGhBY3Rpb25zLmxvZ2luKHBheWxvYWQpKSwgW2Rpc3BhdGNoXSksXHJcbiAgICByZWdpc3RlcjogdXNlQ2FsbGJhY2soKHBheWxvYWQpID0+IGRpc3BhdGNoKGF1dGhBY3Rpb25zLnJlZ2lzdGVyKHBheWxvYWQpKSwgW2Rpc3BhdGNoXSksXHJcbiAgICBsb2dvdXQ6IHVzZUNhbGxiYWNrKCgpID0+IGRpc3BhdGNoKGF1dGhBY3Rpb25zLmxvZ291dCgpKSwgW2Rpc3BhdGNoXSksXHJcbiAgICByZWZyZXNoU2Vzc2lvbjogdXNlQ2FsbGJhY2soKCkgPT4gZGlzcGF0Y2goYXV0aEFjdGlvbnMucmVmcmVzaFNlc3Npb24oKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgbG9hZEN1cnJlbnRVc2VyOiB1c2VDYWxsYmFjaygoKSA9PiBkaXNwYXRjaChhdXRoQWN0aW9ucy5sb2FkQ3VycmVudFVzZXIoKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgdmVyaWZ5RW1haWw6IHVzZUNhbGxiYWNrKChwYXlsb2FkKSA9PiBkaXNwYXRjaChhdXRoQWN0aW9ucy52ZXJpZnlFbWFpbChwYXlsb2FkKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgdmVyaWZ5UGhvbmU6IHVzZUNhbGxiYWNrKChwYXlsb2FkKSA9PiBkaXNwYXRjaChhdXRoQWN0aW9ucy52ZXJpZnlQaG9uZShwYXlsb2FkKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgcmVzZW5kVmVyaWZpY2F0aW9uOiB1c2VDYWxsYmFjaygocGF5bG9hZCkgPT4gZGlzcGF0Y2goYXV0aEFjdGlvbnMucmVzZW5kVmVyaWZpY2F0aW9uKHBheWxvYWQpKSwgW2Rpc3BhdGNoXSksXHJcbiAgICBmb3Jnb3RQYXNzd29yZDogdXNlQ2FsbGJhY2soKHBheWxvYWQpID0+IGRpc3BhdGNoKGF1dGhBY3Rpb25zLmZvcmdvdFBhc3N3b3JkKHBheWxvYWQpKSwgW2Rpc3BhdGNoXSksXHJcbiAgICByZXNldFBhc3N3b3JkOiB1c2VDYWxsYmFjaygocGF5bG9hZCkgPT4gZGlzcGF0Y2goYXV0aEFjdGlvbnMucmVzZXRQYXNzd29yZChwYXlsb2FkKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgY2hhbmdlUGFzc3dvcmQ6IHVzZUNhbGxiYWNrKChwYXlsb2FkKSA9PiBkaXNwYXRjaChhdXRoQWN0aW9ucy5jaGFuZ2VQYXNzd29yZChwYXlsb2FkKSksIFtkaXNwYXRjaF0pLFxyXG4gICAgY2xlYXJFcnJvcjogdXNlQ2FsbGJhY2soKCkgPT4gZGlzcGF0Y2goYXV0aEFjdGlvbnMuY2xlYXJBdXRoRXJyb3IoKSksIFtkaXNwYXRjaF0pLFxyXG4gIH07XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCB1c2VBdXRoO1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7QUFLQSxJQUFBQSxNQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxXQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxVQUFBLEdBQUFGLE9BQUE7QUFNQSxJQUFBRyxLQUFBLEdBQUFILE9BQUE7QUFFQSxJQUFNSSxhQUFhLEdBQUcsU0FBaEJBLGFBQWFB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