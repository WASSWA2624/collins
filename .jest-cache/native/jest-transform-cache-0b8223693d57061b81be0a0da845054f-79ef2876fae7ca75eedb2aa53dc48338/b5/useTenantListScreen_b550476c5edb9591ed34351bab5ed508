22cbad43972f3a76b5cf1b02077d3923
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _react = require("react");
var _expoRouter = require("expo-router");
var _hooks = require("../../../../hooks");
var resolveErrorMessage = function resolveErrorMessage(t, errorCode) {
  if (!errorCode) return null;
  var key = `errors.codes.${errorCode}`;
  var resolved = t(key);
  return resolved === key ? t('errors.codes.UNKNOWN_ERROR') : resolved;
};
var useTenantListScreen = function useTenantListScreen() {
  var _useI18n = (0, _hooks.useI18n)(),
    t = _useI18n.t;
  var router = (0, _expoRouter.useRouter)();
  var _useNetwork = (0, _hooks.useNetwork)(),
    isOffline = _useNetwork.isOffline;
  var _useTenant = (0, _hooks.useTenant)(),
    list = _useTenant.list,
    remove = _useTenant.remove,
    data = _useTenant.data,
    isLoading = _useTenant.isLoading,
    errorCode = _useTenant.errorCode,
    reset = _useTenant.reset;
  var items = (0, _react.useMemo)(function () {
    var _data$items;
    return (_data$items = data == null ? void 0 : data.items) != null ? _data$items : [];
  }, [data == null ? void 0 : data.items]);
  var errorMessage = (0, _react.useMemo)(function () {
    return resolveErrorMessage(t, errorCode);
  }, [t, errorCode]);
  var fetchList = (0, _react.useCallback)(function () {
    reset();
    list({
      page: 1,
      limit: 20
    });
  }, [list, reset]);
  (0, _react.useEffect)(function () {
    fetchList();
  }, [fetchList]);
  var handleRetry = (0, _react.useCallback)(function () {
    fetchList();
  }, [fetchList]);
  var handleTenantPress = (0, _react.useCallback)(function (id) {
    router.push(`/settings/tenants/${id}`);
  }, [router]);
  var handleDelete = (0, _react.useCallback)(function () {
    var _ref = (0, _asyncToGenerator2.default)(function* (id, e) {
      if (e != null && e.stopPropagation) e.stopPropagation();
      try {
        yield remove(id);
        fetchList();
      } catch (_unused) {}
    });
    return function (_x, _x2) {
      return _ref.apply(this, arguments);
    };
  }(), [remove, fetchList]);
  return {
    items: items,
    isLoading: isLoading,
    hasError: Boolean(errorCode),
    errorMessage: errorMessage,
    isOffline: isOffline,
    onRetry: handleRetry,
    onTenantPress: handleTenantPress,
    onDelete: handleDelete
  };
};
var _default = exports.default = useTenantListScreen;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX2V4cG9Sb3V0ZXIiLCJfaG9va3MiLCJyZXNvbHZlRXJyb3JNZXNzYWdlIiwidCIsImVycm9yQ29kZSIsImtleSIsInJlc29sdmVkIiwidXNlVGVuYW50TGlzdFNjcmVlbiIsIl91c2VJMThuIiwidXNlSTE4biIsInJvdXRlciIsInVzZVJvdXRlciIsIl91c2VOZXR3b3JrIiwidXNlTmV0d29yayIsImlzT2ZmbGluZSIsIl91c2VUZW5hbnQiLCJ1c2VUZW5hbnQiLCJsaXN0IiwicmVtb3ZlIiwiZGF0YSIsImlzTG9hZGluZyIsInJlc2V0IiwiaXRlbXMiLCJ1c2VNZW1vIiwiX2RhdGEkaXRlbXMiLCJlcnJvck1lc3NhZ2UiLCJmZXRjaExpc3QiLCJ1c2VDYWxsYmFjayIsInBhZ2UiLCJsaW1pdCIsInVzZUVmZmVjdCIsImhhbmRsZVJldHJ5IiwiaGFuZGxlVGVuYW50UHJlc3MiLCJpZCIsInB1c2giLCJoYW5kbGVEZWxldGUiLCJfcmVmIiwiX2FzeW5jVG9HZW5lcmF0b3IyIiwiZGVmYXVsdCIsImUiLCJzdG9wUHJvcGFnYXRpb24iLCJfdW51c2VkIiwiX3giLCJfeDIiLCJhcHBseSIsImFyZ3VtZW50cyIsImhhc0Vycm9yIiwiQm9vbGVhbiIsIm9uUmV0cnkiLCJvblRlbmFudFByZXNzIiwib25EZWxldGUiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyJ1c2VUZW5hbnRMaXN0U2NyZWVuLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiB1c2VUZW5hbnRMaXN0U2NyZWVuIEhvb2tcclxuICogU2hhcmVkIGxvZ2ljIGZvciBUZW5hbnRMaXN0U2NyZWVuIGFjcm9zcyBwbGF0Zm9ybXMuXHJcbiAqIEZpbGU6IHVzZVRlbmFudExpc3RTY3JlZW4uanNcclxuICovXHJcbmltcG9ydCB7IHVzZUNhbGxiYWNrLCB1c2VFZmZlY3QsIHVzZU1lbW8gfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IHVzZVJvdXRlciB9IGZyb20gJ2V4cG8tcm91dGVyJztcclxuaW1wb3J0IHsgdXNlSTE4biwgdXNlTmV0d29yaywgdXNlVGVuYW50IH0gZnJvbSAnQGhvb2tzJztcclxuXHJcbmNvbnN0IHJlc29sdmVFcnJvck1lc3NhZ2UgPSAodCwgZXJyb3JDb2RlKSA9PiB7XHJcbiAgaWYgKCFlcnJvckNvZGUpIHJldHVybiBudWxsO1xyXG4gIGNvbnN0IGtleSA9IGBlcnJvcnMuY29kZXMuJHtlcnJvckNvZGV9YDtcclxuICBjb25zdCByZXNvbHZlZCA9IHQoa2V5KTtcclxuICByZXR1cm4gcmVzb2x2ZWQgPT09IGtleSA/IHQoJ2Vycm9ycy5jb2Rlcy5VTktOT1dOX0VSUk9SJykgOiByZXNvbHZlZDtcclxufTtcclxuXHJcbmNvbnN0IHVzZVRlbmFudExpc3RTY3JlZW4gPSAoKSA9PiB7XHJcbiAgY29uc3QgeyB0IH0gPSB1c2VJMThuKCk7XHJcbiAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7XHJcbiAgY29uc3QgeyBpc09mZmxpbmUgfSA9IHVzZU5ldHdvcmsoKTtcclxuICBjb25zdCB7XHJcbiAgICBsaXN0LFxyXG4gICAgcmVtb3ZlLFxyXG4gICAgZGF0YSxcclxuICAgIGlzTG9hZGluZyxcclxuICAgIGVycm9yQ29kZSxcclxuICAgIHJlc2V0LFxyXG4gIH0gPSB1c2VUZW5hbnQoKTtcclxuXHJcbiAgY29uc3QgaXRlbXMgPSB1c2VNZW1vKCgpID0+IGRhdGE/Lml0ZW1zID8/IFtdLCBbZGF0YT8uaXRlbXNdKTtcclxuICBjb25zdCBlcnJvck1lc3NhZ2UgPSB1c2VNZW1vKFxyXG4gICAgKCkgPT4gcmVzb2x2ZUVycm9yTWVzc2FnZSh0LCBlcnJvckNvZGUpLFxyXG4gICAgW3QsIGVycm9yQ29kZV1cclxuICApO1xyXG5cclxuICBjb25zdCBmZXRjaExpc3QgPSB1c2VDYWxsYmFjaygoKSA9PiB7XHJcbiAgICByZXNldCgpO1xyXG4gICAgbGlzdCh7IHBhZ2U6IDEsIGxpbWl0OiAyMCB9KTtcclxuICB9LCBbbGlzdCwgcmVzZXRdKTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGZldGNoTGlzdCgpO1xyXG4gIH0sIFtmZXRjaExpc3RdKTtcclxuXHJcbiAgY29uc3QgaGFuZGxlUmV0cnkgPSB1c2VDYWxsYmFjaygoKSA9PiB7XHJcbiAgICBmZXRjaExpc3QoKTtcclxuICB9LCBbZmV0Y2hMaXN0XSk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZVRlbmFudFByZXNzID0gdXNlQ2FsbGJhY2soXHJcbiAgICAoaWQpID0+IHtcclxuICAgICAgcm91dGVyLnB1c2goYC9zZXR0aW5ncy90ZW5hbnRzLyR7aWR9YCk7XHJcbiAgICB9LFxyXG4gICAgW3JvdXRlcl1cclxuICApO1xyXG5cclxuICBjb25zdCBoYW5kbGVEZWxldGUgPSB1c2VDYWxsYmFjayhcclxuICAgIGFzeW5jIChpZCwgZSkgPT4ge1xyXG4gICAgICBpZiAoZT8uc3RvcFByb3BhZ2F0aW9uKSBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IHJlbW92ZShpZCk7XHJcbiAgICAgICAgZmV0Y2hMaXN0KCk7XHJcbiAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgIC8qIGVycm9yIGhhbmRsZWQgYnkgaG9vayAqL1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgW3JlbW92ZSwgZmV0Y2hMaXN0XVxyXG4gICk7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBpdGVtcyxcclxuICAgIGlzTG9hZGluZyxcclxuICAgIGhhc0Vycm9yOiBCb29sZWFuKGVycm9yQ29kZSksXHJcbiAgICBlcnJvck1lc3NhZ2UsXHJcbiAgICBpc09mZmxpbmUsXHJcbiAgICBvblJldHJ5OiBoYW5kbGVSZXRyeSxcclxuICAgIG9uVGVuYW50UHJlc3M6IGhhbmRsZVRlbmFudFByZXNzLFxyXG4gICAgb25EZWxldGU6IGhhbmRsZURlbGV0ZSxcclxuICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgdXNlVGVuYW50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