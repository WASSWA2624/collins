{"version":3,"names":["_react","_interopRequireWildcard","require","_expoRouter","_hooks","_guards","_layouts","_components","_types","_GlobalFooter","_jsxRuntime","AuthLayout","router","useRouter","_useI18n","useI18n","t","_useAuthGuard","useAuthGuard","skipRedirect","authenticated","_useAuth","useAuth","isAuthenticated","logout","_useUiState","useUiState","isLoading","banners","useShellBanners","hasRedirected","useRef","useEffect","current","replace","bannerSlot","length","jsx","ShellBanners","testID","overlaySlot","LoadingOverlay","visible","authHeaderActions","id","label","accessibilityLabel","onPress","variant","ACTION_VARIANTS","GHOST","push","PRIMARY","AuthFrame","header","GlobalHeader","title","actions","banner","overlay","notices","NoticeSurface","footer","default","FOOTER_VARIANTS","AUTH","children","Slot","_default","exports"],"sources":["_layout.jsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\nimport { Slot, useRouter } from 'expo-router';\r\nimport { useAuth, useI18n, useShellBanners, useUiState } from '@hooks';\r\nimport { useAuthGuard } from '@navigation/guards';\r\nimport { AuthFrame } from '@platform/layouts';\r\nimport { GlobalHeader, LoadingOverlay, NoticeSurface, ShellBanners } from '@platform/components';\r\nimport { ACTION_VARIANTS } from '@platform/components/navigation/GlobalHeader/types';\r\nimport GlobalFooter, { FOOTER_VARIANTS } from '@platform/components/navigation/GlobalFooter';\r\n\r\n/**\r\n * Auth Group Layout\r\n * \r\n * Layout wrapper for authentication routes (login, register, etc.).\r\n * \r\n * Per app-router.mdc:\r\n * - Layouts use `_layout.jsx`, default exports, `<Slot />` for child routes\r\n * - Guard placement: guards in layouts, not screens\r\n * \r\n * This layout redirects authenticated users away from auth routes (e.g., login when already logged in).\r\n * Per Step 7.14: Uses useAuthGuard hook with skipRedirect option to get auth state,\r\n * then handles redirect of authenticated users to home route.\r\n */\r\nconst AuthLayout = () => {\r\n  const router = useRouter();\r\n  const { t } = useI18n();\r\n  const { authenticated } = useAuthGuard({ skipRedirect: true });\r\n  const { isAuthenticated, logout } = useAuth();\r\n  const { isLoading } = useUiState();\r\n  const banners = useShellBanners();\r\n  \r\n  // Use ref to track if redirect has been performed to prevent multiple redirects\r\n  const hasRedirected = useRef(false);\r\n  \r\n  useEffect(() => {\r\n    // Redirect authenticated users to home route\r\n    if (authenticated && !hasRedirected.current) {\r\n      hasRedirected.current = true;\r\n      router.replace('/home');\r\n    } else if (!authenticated) {\r\n      // Reset redirect flag when unauthenticated\r\n      hasRedirected.current = false;\r\n    }\r\n  }, [authenticated, router]);\r\n  \r\n  const bannerSlot = banners.length ? <ShellBanners banners={banners} testID=\"auth-shell-banners\" /> : null;\r\n  const overlaySlot = isLoading ? <LoadingOverlay visible testID=\"auth-loading-overlay\" /> : null;\r\n  const authHeaderActions = authenticated || isAuthenticated\r\n    ? [\r\n      {\r\n        id: 'logout',\r\n        label: t('navigation.header.logout'),\r\n        accessibilityLabel: t('navigation.header.logout'),\r\n        onPress: logout,\r\n        variant: ACTION_VARIANTS.GHOST,\r\n      },\r\n    ]\r\n    : [\r\n      {\r\n        id: 'login',\r\n        label: t('auth.login.button'),\r\n        accessibilityLabel: t('auth.login.button'),\r\n        onPress: () => router.push('/login'),\r\n        variant: ACTION_VARIANTS.PRIMARY,\r\n      },\r\n      {\r\n        id: 'register',\r\n        label: t('auth.register.button'),\r\n        accessibilityLabel: t('auth.register.button'),\r\n        onPress: () => router.push('/register'),\r\n        variant: ACTION_VARIANTS.GHOST,\r\n      },\r\n    ];\r\n\r\n  return (\r\n    <AuthFrame\r\n      testID=\"auth-route-layout\"\r\n      header={(\r\n        <GlobalHeader\r\n          title={t('app.name')}\r\n          accessibilityLabel={t('navigation.header.title')}\r\n          testID=\"auth-header\"\r\n          actions={authHeaderActions}\r\n        />\r\n      )}\r\n      banner={bannerSlot}\r\n      overlay={overlaySlot}\r\n      notices={<NoticeSurface testID=\"auth-notice-surface\" />}\r\n      footer={(\r\n        <GlobalFooter\r\n          variant={FOOTER_VARIANTS.AUTH}\r\n          testID=\"auth-footer\"\r\n        />\r\n      )}\r\n    >\r\n      <Slot />\r\n    </AuthFrame>\r\n  );\r\n};\r\n\r\nexport default AuthLayout;\r\n\r\n"],"mappings":"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","ignoreList":[]}