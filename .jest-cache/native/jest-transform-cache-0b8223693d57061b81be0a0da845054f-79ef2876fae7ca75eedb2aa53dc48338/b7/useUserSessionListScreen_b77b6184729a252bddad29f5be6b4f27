a0d6a0af78f4e5fcd70b57e4a23db620
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _react = require("react");
var _expoRouter = require("expo-router");
var _hooks = require("../../../../hooks");
var resolveErrorMessage = function resolveErrorMessage(t, errorCode) {
  if (!errorCode) return null;
  var key = `errors.codes.${errorCode}`;
  var resolved = t(key);
  return resolved === key ? t('errors.codes.UNKNOWN_ERROR') : resolved;
};
var useUserSessionListScreen = function useUserSessionListScreen() {
  var _useI18n = (0, _hooks.useI18n)(),
    t = _useI18n.t;
  var router = (0, _expoRouter.useRouter)();
  var _useNetwork = (0, _hooks.useNetwork)(),
    isOffline = _useNetwork.isOffline;
  var _useUserSession = (0, _hooks.useUserSession)(),
    list = _useUserSession.list,
    revoke = _useUserSession.revoke,
    data = _useUserSession.data,
    isLoading = _useUserSession.isLoading,
    errorCode = _useUserSession.errorCode,
    reset = _useUserSession.reset;
  var items = (0, _react.useMemo)(function () {
    var _data$items;
    return (_data$items = data == null ? void 0 : data.items) != null ? _data$items : [];
  }, [data == null ? void 0 : data.items]);
  var errorMessage = (0, _react.useMemo)(function () {
    return resolveErrorMessage(t, errorCode);
  }, [t, errorCode]);
  var fetchList = (0, _react.useCallback)(function () {
    reset();
    list({
      page: 1,
      limit: 20
    });
  }, [list, reset]);
  (0, _react.useEffect)(function () {
    fetchList();
  }, [fetchList]);
  var handleRetry = (0, _react.useCallback)(function () {
    fetchList();
  }, [fetchList]);
  var handleSessionPress = (0, _react.useCallback)(function (id) {
    router.push(`/settings/user-sessions/${id}`);
  }, [router]);
  var handleRevoke = (0, _react.useCallback)(function () {
    var _ref = (0, _asyncToGenerator2.default)(function* (id, e) {
      if (e != null && e.stopPropagation) e.stopPropagation();
      try {
        yield revoke(id);
        fetchList();
      } catch (_unused) {}
    });
    return function (_x, _x2) {
      return _ref.apply(this, arguments);
    };
  }(), [revoke, fetchList]);
  return {
    items: items,
    isLoading: isLoading,
    hasError: Boolean(errorCode),
    errorMessage: errorMessage,
    isOffline: isOffline,
    onRetry: handleRetry,
    onSessionPress: handleSessionPress,
    onRevoke: handleRevoke
  };
};
var _default = exports.default = useUserSessionListScreen;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX2V4cG9Sb3V0ZXIiLCJfaG9va3MiLCJyZXNvbHZlRXJyb3JNZXNzYWdlIiwidCIsImVycm9yQ29kZSIsImtleSIsInJlc29sdmVkIiwidXNlVXNlclNlc3Npb25MaXN0U2NyZWVuIiwiX3VzZUkxOG4iLCJ1c2VJMThuIiwicm91dGVyIiwidXNlUm91dGVyIiwiX3VzZU5ldHdvcmsiLCJ1c2VOZXR3b3JrIiwiaXNPZmZsaW5lIiwiX3VzZVVzZXJTZXNzaW9uIiwidXNlVXNlclNlc3Npb24iLCJsaXN0IiwicmV2b2tlIiwiZGF0YSIsImlzTG9hZGluZyIsInJlc2V0IiwiaXRlbXMiLCJ1c2VNZW1vIiwiX2RhdGEkaXRlbXMiLCJlcnJvck1lc3NhZ2UiLCJmZXRjaExpc3QiLCJ1c2VDYWxsYmFjayIsInBhZ2UiLCJsaW1pdCIsInVzZUVmZmVjdCIsImhhbmRsZVJldHJ5IiwiaGFuZGxlU2Vzc2lvblByZXNzIiwiaWQiLCJwdXNoIiwiaGFuZGxlUmV2b2tlIiwiX3JlZiIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImRlZmF1bHQiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwiX3VudXNlZCIsIl94IiwiX3gyIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJoYXNFcnJvciIsIkJvb2xlYW4iLCJvblJldHJ5Iiwib25TZXNzaW9uUHJlc3MiLCJvblJldm9rZSIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInVzZVVzZXJTZXNzaW9uTGlzdFNjcmVlbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogdXNlVXNlclNlc3Npb25MaXN0U2NyZWVuIEhvb2tcclxuICogU2hhcmVkIGxvZ2ljIGZvciBVc2VyU2Vzc2lvbkxpc3RTY3JlZW4gYWNyb3NzIHBsYXRmb3Jtcy5cclxuICogRmlsZTogdXNlVXNlclNlc3Npb25MaXN0U2NyZWVuLmpzXHJcbiAqL1xyXG5pbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VNZW1vIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICdleHBvLXJvdXRlcic7XHJcbmltcG9ydCB7IHVzZUkxOG4sIHVzZU5ldHdvcmssIHVzZVVzZXJTZXNzaW9uIH0gZnJvbSAnQGhvb2tzJztcclxuXHJcbmNvbnN0IHJlc29sdmVFcnJvck1lc3NhZ2UgPSAodCwgZXJyb3JDb2RlKSA9PiB7XHJcbiAgaWYgKCFlcnJvckNvZGUpIHJldHVybiBudWxsO1xyXG4gIGNvbnN0IGtleSA9IGBlcnJvcnMuY29kZXMuJHtlcnJvckNvZGV9YDtcclxuICBjb25zdCByZXNvbHZlZCA9IHQoa2V5KTtcclxuICByZXR1cm4gcmVzb2x2ZWQgPT09IGtleSA/IHQoJ2Vycm9ycy5jb2Rlcy5VTktOT1dOX0VSUk9SJykgOiByZXNvbHZlZDtcclxufTtcclxuXHJcbmNvbnN0IHVzZVVzZXJTZXNzaW9uTGlzdFNjcmVlbiA9ICgpID0+IHtcclxuICBjb25zdCB7IHQgfSA9IHVzZUkxOG4oKTtcclxuICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTtcclxuICBjb25zdCB7IGlzT2ZmbGluZSB9ID0gdXNlTmV0d29yaygpO1xyXG4gIGNvbnN0IHtcclxuICAgIGxpc3QsXHJcbiAgICByZXZva2UsXHJcbiAgICBkYXRhLFxyXG4gICAgaXNMb2FkaW5nLFxyXG4gICAgZXJyb3JDb2RlLFxyXG4gICAgcmVzZXQsXHJcbiAgfSA9IHVzZVVzZXJTZXNzaW9uKCk7XHJcblxyXG4gIGNvbnN0IGl0ZW1zID0gdXNlTWVtbygoKSA9PiBkYXRhPy5pdGVtcyA/PyBbXSwgW2RhdGE/Lml0ZW1zXSk7XHJcbiAgY29uc3QgZXJyb3JNZXNzYWdlID0gdXNlTWVtbyhcclxuICAgICgpID0+IHJlc29sdmVFcnJvck1lc3NhZ2UodCwgZXJyb3JDb2RlKSxcclxuICAgIFt0LCBlcnJvckNvZGVdXHJcbiAgKTtcclxuXHJcbiAgY29uc3QgZmV0Y2hMaXN0ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xyXG4gICAgcmVzZXQoKTtcclxuICAgIGxpc3QoeyBwYWdlOiAxLCBsaW1pdDogMjAgfSk7XHJcbiAgfSwgW2xpc3QsIHJlc2V0XSk7XHJcblxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBmZXRjaExpc3QoKTtcclxuICB9LCBbZmV0Y2hMaXN0XSk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZVJldHJ5ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xyXG4gICAgZmV0Y2hMaXN0KCk7XHJcbiAgfSwgW2ZldGNoTGlzdF0pO1xyXG5cclxuICBjb25zdCBoYW5kbGVTZXNzaW9uUHJlc3MgPSB1c2VDYWxsYmFjayhcclxuICAgIChpZCkgPT4ge1xyXG4gICAgICByb3V0ZXIucHVzaChgL3NldHRpbmdzL3VzZXItc2Vzc2lvbnMvJHtpZH1gKTtcclxuICAgIH0sXHJcbiAgICBbcm91dGVyXVxyXG4gICk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZVJldm9rZSA9IHVzZUNhbGxiYWNrKFxyXG4gICAgYXN5bmMgKGlkLCBlKSA9PiB7XHJcbiAgICAgIGlmIChlPy5zdG9wUHJvcGFnYXRpb24pIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgcmV2b2tlKGlkKTtcclxuICAgICAgICBmZXRjaExpc3QoKTtcclxuICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgLyogZXJyb3IgaGFuZGxlZCBieSBob29rICovXHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBbcmV2b2tlLCBmZXRjaExpc3RdXHJcbiAgKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGl0ZW1zLFxyXG4gICAgaXNMb2FkaW5nLFxyXG4gICAgaGFzRXJyb3I6IEJvb2xlYW4oZXJyb3JDb2RlKSxcclxuICAgIGVycm9yTWVzc2FnZSxcclxuICAgIGlzT2ZmbGluZSxcclxuICAgIG9uUmV0cnk6IGhhbmRsZVJldHJ5LFxyXG4gICAgb25TZXNzaW9uUHJlc3M6IGhhbmRsZVNlc3Npb25QcmVzcyxcclxuICAgIG9uUmV2b2tlOiBoYW5kbGVSZXZva2UsXHJcbiAgfTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHVzZVVzZXJTZXNzaW9uTGlzdFNjcmVlbjtcclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFLQSxJQUFBQSxNQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxXQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxNQUFBLEdBQUFGLE9BQUE7QUFFQSxJQUFNRyxtQkFBbUIsR0FBRyxTQUF0QkEsbUJBQW1CQSxDQUFJQyxDQUFDLEVBQUVDLFNBQVMsRUFBSztFQUM1QyxJQUFJLENBQUNBLFNBQVMsRUFBRSxPQUFPLElBQUk7RUFDM0IsSUFBTUMsR0FBRyxHQUFHLGdCQUFnQkQsU0FBUyxFQUFFO0VBQ3ZDLElBQU1FLFFBQVEsR0FBR0gsQ0FBQyxDQUFDRSxHQUFHLENBQUM7RUFDdkIsT0FBT0MsUUFBUSxLQUFLRCxHQUFHLEdBQUdGLENBQUMsQ0FBQyw0QkFBNEIsQ0FBQyxHQUFHRyxRQUFRO0FBQ3RFLENBQUM7QUFFRCxJQUFNQyx3QkFBd0IsR0FBRyxTQUEzQkEsd0JBQXdCQSxDQUFBLEVBQVM7RUFDckMsSUFBQUMsUUFBQSxHQUFjLElBQUFDLGNBQU8sRUFBQyxDQUFDO0lBQWZOLENBQUMsR0FBQUssUUFBQSxDQUFETCxDQUFDO0VBQ1QsSUFBTU8sTUFBTSxHQUFHLElBQUFDLHFCQUFTLEVBQUMsQ0FBQztFQUMxQixJQUFBQyxXQUFBLEdBQXNCLElBQUFDLGlCQUFVLEVBQUMsQ0FBQztJQUExQkMsU0FBUyxHQUFBRixXQUFBLENBQVRFLFNBQVM7RUFDakIsSUFBQUMsZUFBQSxHQU9JLElBQUFDLHFCQUFjLEVBQUMsQ0FBQztJQU5sQkMsSUFBSSxHQUFBRixlQUFBLENBQUpFLElBQUk7SUFDSkMsTUFBTSxHQUFBSCxlQUFBLENBQU5HLE1BQU07SUFDTkMsSUFBSSxHQUFBSixlQUFBLENBQUpJLElBQUk7SUFDSkMsU0FBUyxHQUFBTCxlQUFBLENBQVRLLFNBQVM7SUFDVGhCLFNBQVMsR0FBQVcsZUFBQSxDQUFUWCxT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